@using Microsoft.AspNetCore.Mvc.ViewFeatures
@model dynamic
@{
    var rootId = (string)(Model?.SectionId ?? $"tabs-{Guid.NewGuid():N}");
    var tabs = (IList<dynamic>)(Model?.Tabs ?? new List<dynamic>()); // [{ Title, Html }]
}

@if (tabs == null || tabs.Count == 0)
{
    <div class="alert alert-secondary mb-0">No tabs configured.</div>
}
else
{
    <ul class="nav nav-tabs mt-4" id="@rootId" role="tablist">
        @for (int i = 0; i < tabs.Count; i++)
        {
            <li class="nav-item" role="presentation">
                <button class="nav-link @(i == 0 ? "active" : "")"
                        data-bs-toggle="tab"
                        data-bs-target="#@(rootId)_pane_@i"
                        type="button" role="tab"
                        aria-controls="@(rootId)_pane_@i"
                        aria-selected="@(i == 0 ? "true" : "false")">
                    @(tabs[i]?.Title ?? $"Tab {i + 1}")
                </button>
            </li>
        }
    </ul>

    <div class="tab-content bg-dark rounded-bottom p-3 border border-top-0">
        @for (int i = 0; i < tabs.Count; i++)
        {
            <div class="tab-pane fade show @(i == 0 ? "active" : "")"
                 id="@(rootId)_pane_@i" role="tabpanel">
                @PaladinHub.Infrastructure.SafeHtmlExtensions.SafeHtml(
                (IHtmlHelper)Html,
                tabs[i]?.Html?.ToString() ?? ""
                )
    </div>
        }
</div>
}
